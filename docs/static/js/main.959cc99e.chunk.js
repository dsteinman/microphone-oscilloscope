(this["webpackJsonpmicrophone-oscilloscope"]=this["webpackJsonpmicrophone-oscilloscope"]||[]).push([[0],{12:function(e,t,n){e.exports=n(19)},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(5),r=n.n(a),c=(n(17),n(2)),s=n.n(c),l=n(1),h=n(3),u=n(6),d=n(7),m=n(10),p=n(11),f=n(8),g=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var i;return Object(u.a)(this,n),(i=t.call(this)).options=e||{},i.chunkSize="chunkSize"in e?e.chunkSize:8192,i.volume="volume"in e?e.volume:1,i}return Object(d.a)(n,[{key:"createAudioProcessor",value:function(e,t){var n=this,i=e.createScriptProcessor(this.chunkSize,1,1),o=t.context.sampleRate;return i.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);if(n.muted){for(var i=0;i<t.length;i++)t[i]=0;console.log("muted")}n.emit("data",t,o)},i.shutdown=function(){i.disconnect(),n.onaudioprocess=null},i}},{key:"start",value:function(){var e=this;this.audioContext=new AudioContext;var t=function(t){console.log("started recording"),e.mediaStream=t,e.mediaStreamSource=e.audioContext.createMediaStreamSource(t),e.processor=e.createAudioProcessor(e.audioContext,e.mediaStreamSource),e.mediaStreamSource.connect(e.processor),e.gainNode=e.audioContext.createGain(),e.mediaStreamSource.connect(e.gainNode),e.gainNode.gain.value=e.volume,e.muted&&(e._gain=e.gainNode.gain.value,e.gainNode.gain.value=0),e.gainNode.connect(e.processor),e.processor.connect(e.audioContext.destination),e.options.analyzer&&(e.audioAnalyser=e.audioContext.createAnalyser(),e.gainNode.connect(e.audioAnalyser),e.emit("analyser",e.audioAnalyser))},n=function(e){console.error("recording failure",e)};if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var i=this.options.microphone,o={audio:{deviceId:i?{exact:i}:void 0}};navigator.mediaDevices.getUserMedia(o).then(t).catch(n)}else navigator.getUserMedia({video:!1,audio:!0},t,n)}},{key:"stop",value:function(){this.mediaStream&&this.mediaStream.getTracks()[0].stop(),this.mediaStreamSource&&this.mediaStreamSource.disconnect(),this.processor&&this.processor.shutdown(),this.audioContext&&this.audioContext.close()}},{key:"setVolume",value:function(e){this.volume=e,this._gain=e,this.gainNode.gain.value=e}},{key:"setMuted",value:function(e){this.muted=e,this.gainNode&&(e?(this._gain=this.gainNode.gain.value,this.gainNode.gain.value=0):this.gainNode.gain.value=this._gain||1)}}]),n}(n.n(f).a),v=n(9),x=n.n(v);function S(){return k.apply(this,arguments)}function k(){return(k=Object(h.a)(s.a.mark((function e(){var t,n,i,o,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:t=e.sent,n=[],i=0;case 5:if(i===t.length){e.next=16;break}if("audioinput"!==(o=t[i]).kind){e.next=13;break}if(a=o.deviceId,r=o.label||"microphone "+i,!(0===i&&r.toLowerCase().indexOf("default")>-1)){e.next=12;break}return e.abrupt("continue",13);case 12:n.push({id:a,name:r});case 13:++i,e.next=5;break;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=[];function C(e){var t=[[],[]],n=function(){var e;if(window.AudioContext)e=new window.AudioContext;else{if(!window.webkitAudioContext)throw new Error("no AudioContext");console.log("creating webkitAudioContext"),e=new window.webkitAudioContext}return e}(),i=new x.a(n),o=function(n,o){t[n].push(o),function(){if(t[0].length&&t[1].length)if(t[0].length==t[1].length){var n=t[0].shift(),o=t[1].shift();e?i.processChannels(n,o,e):console.log("no caanvas")}else console.log("oops",t[0].length,t[0].length);else t[0].length&&0===t[1].length?t[0]=[t[0].pop()]:t[1].length&&0===t[0].length&&(t[1]=[t[0].pop()])}()};b[0].on("data",(function(e){o(0,e)})),b[1].on("data",(function(e){o(1,e)}))}function w(e,t){return b[e]=new g({microphone:t.id,chunkSize:512}),b[e].start(),b[e]}function y(e){var t,n=e.mic1?"Right":"Left";return e.mics.length<2?(1===e.mics.length&&(t=o.a.createElement("div",null,"Found 1 microphone: ",e.mics[0].name)),o.a.createElement("div",null,"Sorry this demo requires 2 microphones.",o.a.createElement("br",null),o.a.createElement("br",null),t)):o.a.createElement("div",{className:"choose"},o.a.createElement("strong",null,"Choose ",n," Microphone:"),o.a.createElement("ul",null,e.mics.map((function(t,n){return e.mic1&&t.id===e.mic1.id?o.a.createElement("li",{key:n},"LEFT: ",t.name):e.mic2&&t.id===e.mic2.id?o.a.createElement("li",{key:n},"RIGHT: ",t.name):o.a.createElement("li",{key:n},o.a.createElement("a",{href:"#",onClick:function(n){n.preventDefault(),e.onChooseMic(t)}},t.name))}))))}var E=function(){var e,t=Object(i.useState)([]),n=Object(l.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(null),u=Object(l.a)(c,2),d=u[0],m=u[1],p=Object(i.useState)(null),f=Object(l.a)(p,2),g=f[0],v=f[1],x=Object(i.useState)(!1),k=Object(l.a)(x,2),b=k[0],E=k[1],A=Object(i.useState)(!1),O=Object(l.a)(A,2),j=O[0],N=O[1],z=o.a.createRef();return Object(i.useEffect)((function(){!j&&z.current&&(z.current.width=window.innerWidth,z.current.height=window.innerHeight,N(!0),C(z.current)),Object(h.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=5;break}return e.next=3,S();case 3:t=e.sent,r(t);case 5:case"end":return e.stop()}}),e)})))()})),e=b?o.a.createElement("div",null,o.a.createElement("canvas",{ref:z,id:"c"})):o.a.createElement(y,{mics:a,onChooseMic:function(e){d?g||(v(e),w(1,e),E(!0)):(m(e),w(0,e))},mic1:d,mic2:g}),o.a.createElement("div",{className:"App"},e)};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(E,null)),document.getElementById("root"))},9:function(e,t){function n(e){this.buffersize=512,this.xp=null,this.yp=null,this.theme={dotSize:0,dotStrokeWidth:0,dotStrokeColor:null,dotFillColor:null,lineThickness:1,lineCap:"round",lineColor:"#FFF"}}n.prototype.clear=function(){var e=this.canvas.width,t=this.canvas.height;this.context.clearRect(0,0,e,t)},n.prototype.processChannels=function(e,t,n){if(e&&t){this.context=n.getContext("2d");var i=e,o=t,a=n.width,r=n.height;this.context.clearRect(0,0,a,r);for(var c=0;c<this.buffersize;c++){if(null!==this.xp&&null!==this.yp){var s=.5*(i[c]+1)*a,l=.5*(1-o[c])*r;this.theme.dotSize&&(this.context.globalAlpha=this.theme.dotAlpha,this.context.lineCap=this.theme.lineCap,this.theme.dotFillColor&&(this.context.fillStyle=this.theme.dotFillColor),this.theme.dotStrokeWidth&&(this.context.lineWidth=this.theme.dotStrokeWidth),this.theme.dotStrokeColor&&(this.context.strokeStyle=this.theme.dotStrokeColor),this.context.beginPath(),this.theme.dotStrokeWidth&&(this.context.arc(s,l,.5*(this.theme.dotSize+this.theme.dotStrokeWidth),0,2*Math.PI,!1),this.context.fill()),this.context.arc(s,l,.5*this.theme.dotSize,0,2*Math.PI,!1),this.theme.dotFillColor&&this.context.fill()),this.theme.lineThickness&&("lineAlpha"in this.theme&&(this.context.globalAlpha=this.theme.lineAlpha),this.context.strokeStyle=this.theme.lineColor,this.context.lineCap=this.theme.lineCap,this.context.lineWidth=this.theme.lineThickness,this.context.beginPath(),this.context.moveTo(s,l),this.context.lineTo(this.xp,this.yp),this.context.stroke())}this.xp=s,this.yp=l}}},e.exports=n}},[[12,1,2]]]);
//# sourceMappingURL=main.959cc99e.chunk.js.map